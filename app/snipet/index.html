<!DOCTYPE html>
<html lang="pl">
<head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
   <meta http-equiv="x-ua-compatible" content="ie=edge" />
   <title>SNIPET 3</title>
   <meta name="HandheldFriendly" content="true">
   <meta name="mobile-web-app-capable" content="yes"> 
   <meta name="theme-color" content="gold">
   <link rel="shortcut icon" type="image/svg+xml" size="any" href="../../img/dom.svg"> 
   <link rel="manifest" href="../../zorro.web.json">   
   <link rel="stylesheet" href="../../css/style.css" />
   <link rel="stylesheet" href="../../css/all.css" />
   
<style>
   h3,h2 {font-size:1.2em}
.code {
    font-family: monospace;
    background: white;
    border: 1px solid gray;
    padding: 0.5em;
    font-size: xx-small;
    white-space: break-spaces;
    line-break: anywhere;
    display: flex;
}
   div#klawisze>div {box-shadow: 0px 4px 8px rgb(0 0 0 / 20%);padding:0.25em;}
   div#klawisze>div>span {display:inline-block; min-width:3.0em;}
   div#klawisze>div>button {background-color: #777;color: white;}
</style>
<script>
const snipARR = [
   {n:"index",           f:"html",   u:"index.html"},
   {n:"fetch",           f:"js",     u:"fetch.js"},
   {n:"createElement",   f:"js",     u:"createElement.js"},
   {n:"active",          f:"js",     u:"active.js"},
   {n:"dom",             f:"js",     u:"domReady.js"},
   
];
let actualDOC=0;
   
const showButtonsByFolders=()=>{
      let folders={}
      snipARR.forEach((o,i)=>{
         folders[o.f] = [];
      });
      snipARR.forEach((o,i)=>{
         let u = o.f+'/'+o.u;
         folders[o.f].push(`<button data-index="${i}" onclick='ShowNow(this,"${u}",${i})'>${o.n}</button>`);
      });
      for (const f in folders){
         let html = "<div><span>"+f+": </span>"+folders[f].join("")+"</div>";
         document.getElementById("klawisze").innerHTML += html;   
      }
}   

//---dom ready--------------------------------
document.addEventListener("DOMContentLoaded",function(){
      showButtonsByFolders();
})
//---DOM READY----------------------------------   
  

const getCode=(url,callback)=>{
   fetch(url)
  .then(ret => {return ret.text()})
  .then(code => {
      callback(code);
   }).catch(e => {console.log(e)})
}   

const getLocalURL=url=>{
   let o = snipARR[actualDOC];
   url = (url) ? url : o.f+"/"+o.u;
   return url;
}
const getURL=url=>'https://znakzorro.github.io/zorro/app/EDEK/?url='+location.href+url;
   
const show=(url)=>{
   url = getLocalURL(url);
   console.log(77,url);
   let exurl = location.href+url
   console.log(exurl,"show");
   getCode(url,function(code){
        console.log("show==",code);   
   })
}
const save=(url)=>{
   url = getLocalURL(url);
   console.log(77,url);
   let exurl = location.href+url
   console.log(exurl,"save");   
   getCode(url,(code)=>{
        console.log("save==",code);   
   })
}
const edit=(url)=>{   
   url = getLocalURL(url);
   console.log(77,url);
   let exurl = getURL(url);//'https://znakzorro.github.io/zorro/app/EDEK/?url='+location.href+url;
   window.open(exurl,"_self");  
}


/*qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq*/   
const ShowNow=(ten,url,i)=>{
      actualDOC = i;
      console.log("actualDOC=",actualDOC,snipARR[actualDOC]);
      document.querySelectorAll("#klawisze button").forEach(b=>b.classList.remove("active"));
      ten.classList.add("active");
   
      fetch(url)
        .then(ret => {return ret.text()})
        .then(code => {
            //console.log(i);
            //console.log(code)
            /*let html = `<button class="adm" onclick='edit("${url}")'>edit</button>`;
               html += `<button class="adm" onclick='show("${url}")'>show</button>`;
               html += `<button class="adm" onclick='save("${url}")'>save</button>`;
            document.getElementById("edits").innerHTML += html*/


            document.getElementById("snipet").textContent = code;
            ten.classList.add("active");
      })
        .catch(e => {console.log(e)})   
} 

document.addEventListener("DOMContentLoaded",function(){
    let first = document.querySelector("#klawisze button");
    if (first) first.click(); 
});
</script>
</head>

<body>
    <div class="wrapper">
        <app-menu title="SNIPET" name="ZnakZorro" link="../../"></app-menu>
        <script src="../../appMenu.js"></script>
       
        <div class="container" id="klawisze"></div>
       <div class="container" id="edits">
            <button class="adm" onclick="show()">show</button>
            <button class="adm" onclick="save()">save</button>          
            <button class="adm" onclick="edit()">edit</button>
            <hr />
       </div>
       
        <div class="container code" id="snipet"></div>
    </div>
  
  </body>
</html>
