<!DOCTYPE html>
<html lang="pl">
<head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
   <meta http-equiv="x-ua-compatible" content="ie=edge" />
   <title>SNIPET 3</title>
   <meta name="HandheldFriendly" content="true">
   <meta name="mobile-web-app-capable" content="yes"> 
   <meta name="theme-color" content="gold">
   <link rel="shortcut icon" type="image/svg+xml" size="any" href="../../img/dom.svg"> 
   <link rel="manifest" href="../../zorro.web.json">   
   <link rel="stylesheet" href="../../css/style.css" />
   <link rel="stylesheet" href="../../css/all.css" />
   
<style>
   h3,h2 {font-size:1.2em}
.code {
    font-family: monospace;
    background: white;
    border: 1px solid gray;
    padding: 0.5em;
    font-size: xx-small;
    white-space: break-spaces;
    line-break: anywhere;
    display: flex;
}
</style>
<script>
const snipARR = [
   {n:"index",           f:"html",   u:"index.html"},
   {n:"fetch",           f:"js",     u:"fetch.js"},
   {n:"createElement",   f:"js",     u:"createElement.js"},
   {n:"active",          f:"js",     u:"active.js"},
   {n:"dom",             f:"js",     u:"domReady.js"},
   
];
   
const showButtons=()=>{
      console.log("dom ready",snipARR); 
      let html ="";
      snipARR.forEach((o,i)=>{
         let u = o.f+'/'+o.u;
         html += `<button data-index="${i}" onclick='ShowNow(this,"${u}",${i})'>${o.n}</button>`;
      });
      console.log(html); 
      document.getElementById("klawisze").innerHTML = html;   
}   

const showButtonsByFolders=()=>{
      console.log("dom ready",snipARR); 
      let html ="";
      let folders={}
      snipARR.forEach((o,i)=>{
         folders[o.f] = [];
      });
      console.log(1,folders);
      snipARR.forEach((o,i)=>{
         let u = o.f+'/'+o.u;
         folders[o.f].push(`<button data-index="${i}" onclick='ShowNow(this,"${u}",${i})'>${o.n}</button>`);
      });
      console.log("ffffffffff",folders);
      for (const f in folders){
         console.log(f,folders[f]); 
      }
      //console.log(html); 
      //document.getElementById("klawisze").innerHTML = html;   
}   

//---dom ready--------------------------------
document.addEventListener("DOMContentLoaded",function(){
      showButtons();
      showButtonsByFolders()
})
//---DOM READY----------------------------------   
  

const getCode=(url,callback)=>{
   fetch(url)
  .then(ret => {return ret.text()})
  .then(code => {
      callback(code);
   }).catch(e => {console.log(e)})
}   

const getURL=url=>'https://znakzorro.github.io/zorro/app/EDEK/?url='+location.href+url;
   
const edit=(url)=>{
   let exurl = getURL(url);//'https://znakzorro.github.io/zorro/app/EDEK/?url='+location.href+url;
   window.open(exurl,"_self");  
}
const show=(url)=>{
   let exurl = location.href+url
   console.log(exurl,"show");
   getCode(url,function(code){
        console.log("show==",code);   
   })
}
const save=(url)=>{
   let exurl = location.href+url
   console.log(exurl,"save");   
   getCode(url,(code)=>{
        console.log("save==",code);   
   })
}

/*qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq*/   
const ShowNow=(ten,url,i)=>{
      document.querySelectorAll("#klawisze button").forEach(b=>b.classList.remove("active"));
      ten.classList.add("active");
   
      fetch(url)
        .then(ret => {return ret.text()})
        .then(code => {
            //console.log(i);
            //console.log(code)
            let html = `<button class="adm" onclick='edit("${url}")'>edit</button>`;
               html += `<button class="adm" onclick='show("${url}")'>show</button>`;
               html += `<button class="adm" onclick='save("${url}")'>save</button>`;
            document.getElementById("edits").innerHTML = html

            //html += `<div class="code" id="code">${code}</div>`;
            //html += `<div class="code" id="code">${encodeURIComponent(code)}</div>`;

            document.getElementById("snipet").textContent = code;
            ten.classList.add("active");
      })
        .catch(e => {console.log(e)})   
} 

document.addEventListener("DOMContentLoaded",function(){
    let first = document.querySelector("#klawisze button");
    if (first) first.click(); 
});
</script>
</head>

<body>
    <div class="wrapper">
        <app-menu title="SNIPET" name="ZnakZorro" link="../../"></app-menu>
        <script src="../../appMenu.js"></script>
       
        <div class="container" id="klawisze">
          
          <button class="btn blue" onclick='ShowNow(this,"html/index.html")'>index</button>
          <button class="btn" onclick='ShowNow(this,"js/fetch.js")'>fetch</button> 
          <button class="btn" onclick='ShowNow(this,"js/createElement.js")'>create</button> 
          
        </div>
       <div class="container" id="edits"></div>
       
        <div class="container code" id="snipet"></div>
    </div>
  
  </body>
</html>
