<!DOCTYPE html>
<html lang="pl">
<head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
   <meta http-equiv="x-ua-compatible" content="ie=edge" />
   <title>BLE</title>  
   <meta name="HandheldFriendly" content="true">
   <meta name="mobile-web-app-capable" content="yes"> 
   <meta name="theme-color" content="#880">



<script>
  async function getBattery(){
       navigator.bluetooth.requestDevice({ filters: [{ services: ['battery_service'] }] })
     .then(device => device.gatt.connect())
     .then(server => {
       // Getting Battery Serviceâ€¦
       return server.getPrimaryService('battery_service');
     })
     .then(service => {
       console.log(service)
       return service.getCharacteristic('battery_level');
     })
     .then(characteristic => {
        console.log(characteristic)
       return characteristic.readValue();
     })
     .then(value => {
       console.log(`Battery percentage is ${value.getUint8(0)}`);
     })
     .catch(error => { console.error(error); });
}
   
async function testBattery(){
     await getBattery();
}
  
</script>

</head>
<body>
      <button onclick="getBattery()">getBattery</button>
      <button onclick="testBattery()">testBattery</button>
</body>
</html>
