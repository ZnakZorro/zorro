
<!DOCTYPE html>
<html lang="pl">
<head>
   <meta charset="UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
   <meta http-equiv="x-ua-compatible" content="ie=edge" />
   <title>Filters</title>  
   <meta name="HandheldFriendly" content="true">
   <meta name="mobile-web-app-capable" content="yes"> 
   <meta name="theme-color" content="#008">
   <link rel="shortcut icon" type="image/svg+xml" size="any" href="../../../img/dom.svg"> 
   <link rel="manifest" href="../../../zorro.web.json"> 
   <link rel="stylesheet" href="../../../css/style.css" />
   <link rel="stylesheet" href="../../../css/all.css" />
   <style>
    .b {font-weight:bold;} 
    .line {margin:0.2em 0;}
    .em3,.em4,.em5,.em6 {display: inline-block;}
    .em3 {width: 3em;}
    .em4 {width: 4em;}
    .em5 {width: 5em;}
    .em6 {width: 6em;}

    .active {background-color: :red; color:white;}
    .elem {font-weight: bold; font-size:36px; cursor:pointer;font-family:sans-serif;stroke-width:1.33;}
/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 2; /* Sit on top */
  padding-top: 2em; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
.btn {z-index: 1!important;}

   </style>
        <script src="https://code.highcharts.com/highcharts.js"></script>
        <script src="https://code.highcharts.com/modules/series-label.js"></script>
        <script src="https://code.highcharts.com/modules/exporting.js"></script>
        <script src="https://code.highcharts.com/modules/export-data.js"></script>
        <script src="https://code.highcharts.com/modules/accessibility.js"></script> 
        <script src="./js/wykresy.js"></script> 
   <script>
      const $=e=>document.querySelector(e);
      const $$=e=>document.querySelectorAll(e);
      document.addEventListener("DOMContentLoaded",function(){
         //document.getElementById("info").textContent = "info";
      });
   </script>
</head>


<script>
const obliczFiltrCR=(ff,frq,R1,C1)=>{
    let impedancja = 1/(2 * Math.PI * ff * C1);
    let gain = R1/(R1+impedancja);
    return gain;

}   

const calcCR=()=>{
    let C1 = parseFloat(document.getElementById("capasitor1").value);
    let R1 = parseFloat(document.getElementById("resistor1").value);
    C1 = C1/1000000;
    R1=R1;
    console.log(C1,R1,Math.PI);
    let frq = 1/(2 * Math.PI * R1 * C1);
    let frqi = Math.round(frq);
    document.getElementById("frq").value = frqi;

	let skala = 1;
	let data = []
	for (f=20;f<20000;f+=10){
		let ff=f;
		gain=obliczFiltrCR(ff,frq,R1,C1);
        dB= 8.65*Math.log(gain/skala);
        dB = Math.round(dB*100)/100;
		//dB= gain    //20*Math.log(gain/skala);
		data.push([ff,dB]);
    }
    //console.log(data)
	if (wykres) updateWykres(data); else rysujWykres("highchart",data);    
}  
//---dom ready--------------------------------
document.addEventListener("DOMContentLoaded",function(){
    calcCR();
})
//---DOM READY----------------------------------

</script>
<body>

    <div class="wrapper">
            <app-menu title="CR-f" name="ZnakZorro" link="../../../"></app-menu><script src="../../../appMenu.js"></script>        
               <div class="container">
                  <!-- Trigger/Open The Modal -->
                  <!--button id="myBtn">Open Modal</button-->
                  <!-- The Modal -->
                  <div id="myModal" class="modal">
                     <!-- Modal content -->
                     <div class="modal-content">
                        <span id="close" class="close">&times;</span>
                        <span id="modaResult">33 E</span>
                        <div><input type="range" min="0" max="100" value="33" oninput="rangeChange(this)" style="width: 100%;margin-top: 1em; "/></div>
                     </div>
                  </div>
               </div>
               <div class="container">
            <figure class="highcharts-figure">
                <div id="highchart"></div>
                <p class="highcharts-description"></p>
            </figure>
        </div>
    </div>
    
    <div class="wrapper">
        <div class="container">
            <h3>FCR</h3> 
            
            <div  style="">   
                <?xml version="1.0" encoding="UTF-8" standalone="no"?>
                <svg
                   version="1.1"
                   viewBox="0 0 260 200"
                   id="svg287"
                   sodipodi:docname="filter-low_RC.svg"
                   inkscape:version="1.2.1 (0f2f062aeb, 2022-09-21, custom)"
                   width="260"
                   height="200"
                   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
                   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
                   xmlns="http://www.w3.org/2000/svg"
                   xmlns:svg="http://www.w3.org/2000/svg">
                  <defs
                     id="defs291" />
                  <sodipodi:namedview
                     id="namedview289"
                     pagecolor="#ffffff"
                     bordercolor="#666666"
                     borderopacity="1.0"
                     inkscape:showpageshadow="2"
                     inkscape:pageopacity="0.0"
                     inkscape:pagecheckerboard="0"
                     inkscape:deskcolor="#d1d1d1"
                     showgrid="false"
                     inkscape:zoom="3.992207"
                     inkscape:cx="119.73327"
                     inkscape:cy="103.57679"
                     inkscape:window-width="1846"
                     inkscape:window-height="1016"
                     inkscape:window-x="0"
                     inkscape:window-y="0"
                     inkscape:window-maximized="1"
                     inkscape:current-layer="svg287" />
                  <path
                     d="M 31.778992,185.48833 H 228.96093"
                     id="path181"
                     style="stroke:#000000;stroke-width:2.83881"
                     sodipodi:nodetypes="cc" />
                  <g
                     transform="matrix(0,1.3452705,-1.4976298,0,245.13008,76.044905)"
                     id="g197"
                     style="font-family:sans-serif;fill:#cccccc;stroke:#000000;stroke-width:2">
                    <path
                       d="M -22.724056,8 79.2545,8.3395307"
                       id="path193"
                       sodipodi:nodetypes="cc"
                       style="fill:#cccccc" />
                    <rect
                       x="12"
                       y="4"
                       width="24"
                       height="8"
                       fill="#ffffff"
                       id="rect195"
                       style="fill:#cccccc" />
                  </g>
                  <g
                     transform="matrix(-1.3452705,0,0,-1.4976298,37.296563,55.839459)"
                     id="g257"
                     style="font-family:sans-serif;fill:none;stroke:#000000;stroke-width:2">
                    <circle
                       cx="8"
                       cy="8"
                       r="3"
                       fill="#ffffff"
                       id="circle255" />
                  </g>
                  <g
                     transform="matrix(-1.3452705,0,0,-1.4976298,37.808225,197.28731)"
                     id="g263"
                     style="font-family:sans-serif;fill:none;stroke:#000000;stroke-width:2">
                    <circle
                       cx="8"
                       cy="8"
                       r="3"
                       fill="#ffffff"
                       id="circle261" />
                  </g>
                  <circle
                     style="fill:#000000;stroke-width:5"
                     id="path833"
                     cx="232.8183"
                     cy="44.420261"
                     r="5.2828536" />
                  <circle
                     style="fill:#000000;stroke-width:5"
                     id="path833-3"
                     cx="232.53101"
                     cy="184.88632"
                     r="5.2828536" />
                  <g
                     id="g1560"
                     transform="translate(14,38)">
                    <path
                       style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                       d="m 225.93145,59.254141 10.78633,-7.407526"
                       id="path350" />
                    <path
                       style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                       d="m 225.37351,80.021939 11.20756,6.009654"
                       id="path354" />
                    <path
                       style="fill:none;stroke:#000000;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"
                       d="m 236.3913,51.877598 0.0203,34.286079"
                       id="path356" />
                  </g>
                  
                  <g
                     id="g1516-7"
                     transform="matrix(0,1.5617517,-1.9478936,0,229.05245,-203.20458)">
                    <path
                       d="M 168.64972,51.603273 H 147.12539"
                       id="path173-7-9"
                       style="stroke:#000000;stroke-width:2.83881" />
                    <path
                       d="M 168.51107,59.837473 H 146.98674"
                       id="path173-7-3-2"
                       style="stroke:#000000;stroke-width:2.83881" />
                  </g>
                  <path
                     style="fill:none;stroke:#000000;stroke-width:2.54526;stroke-linecap:butt;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1"
                     d="m 131.00083,44.847703 c 0,0 45.7282,-0.255691 101.30729,-0.09355"
                     id="path629-6-0-2"
                     sodipodi:nodetypes="cc" />
                  <path
                     style="fill:none;stroke:#000000;stroke-width:2.5;stroke-linecap:butt;stroke-linejoin:miter;stroke-dasharray:none;stroke-opacity:1"
                     d="M 110.65541,44.613174 29.952509,44.595784"
                     id="path629-5-2-7-3"
                     sodipodi:nodetypes="cc" />

                  <text>
                     <title id="title1822">kondensator C1</title>
                     <tspan id="FCR_C1_1" x="110" y="92" class="click elem" title="capasitor C1"  >3.3uF</tspan>
                  </text>
                  <text>
                     <title>Speaker</title>
                     <tspan id="FCR_Rg_1" x="140" y="130" class="click elem">8E</tspan>
                  </text>
                  <text>
                     <title id="FCR_1_title">FRQ</title>
                     <tspan id="FCR_1_result" x="80" y="170" class="click elem" title="capasitor C1">1999Hz</tspan>
                  </text>

                </svg>
                
            </div>
            <div class="line"><span class="em3 b">C:</span>    <input class="em4" id="capasitor1"     onchange="calcCR()" value="10"> uF</div>
            <div class="line"><span class="em3 b">R:</span>    <input class="em4" id="resistor1" onchange="calcCR()" value="8"> Om</div>
            <div class="line"><span class="em3 b"></span>      <button class="btn em6"           onClick="calcCR()">Calc CR</button></div>
            <div class="line"><span class="em3 b">FRQ:</span>  <input class="em4 b" id="frq"> Hz</div>
        </div>
    </div>
</body>
</html>

<script>

const rangeChange=(ten)=>{
   let miano = "E";
   let val = ten.value;
   console.log(ten,ten.id,val)
   document.getElementById("modaResult").textContent=val+miano;
   $("#FCR_Rg_1").textContent = val+miano;
   oblicz_FCR();
}
const openModal=(ten)=>{
   console.log(ten)
   //oblicz_FCR
   let arr = ten.id.split("_")
   console.log("openModal=",arr)
   modal.style.display = "block";
   ten.setAttribute("fill", "red")
}
const closeModal=()=>{
   modal.style.display = "none";
   document.querySelectorAll(".click").forEach((el)=>{el.removeAttribute("fill");})
   oblicz_FCR()
}
const listenElement=(el)=>{
    let txtel = el.target
    //txtel.classList.add("active")
    //console.log(el.target)
    //console.log(el.target.id,el.target.textContent)
    //txtel.setAttribute("stroke", "blue")
    //txtel.setAttribute("fill", "red")
    //txtel.setAttribute("stroke-width", "4")
    openModal(txtel)
    
}

const oblicz_FCR=()=>{
   let C1x  = $("#FCR_C1_1").textContent;
   let Rg1x = $("#FCR_Rg_1").textContent;
   let C1 = parseFloat(C1x);
   let RG = parseFloat(Rg1x);
   C1 = C1 / 1000000;
   RG = RG; 
   console.log(C1x,Rg1x, RG,C1)
   let frq = 1/(2 * Math.PI * RG * C1);
   let frqi = Math.round(frq);
   $("#FCR_1_result").textContent=frqi+"Hz"
   
}
    document.addEventListener("DOMContentLoaded",function(){

        //document.querySelector("#FCR_C1_1").addEventListener('click', listenElement, false);
        //document.querySelector("#FCR_Rg_1").addEventListener('click', listenElement, false);
        //let clicks=document.querySelectorAll(".click")
        //console.log(clicks)
        document.querySelectorAll(".click").forEach((el)=>{
            el.addEventListener('click', listenElement, false);
        })
        oblicz_FCR();
        
    });
</script>

<script>
   // Get the modal
   var modal = document.getElementById("myModal");
   
   // Get the button that opens the modal
   var btn = document.getElementById("myBtn");
   
   // Get the <span> element that closes the modal
   var span = document.getElementById("close");
   
   // When the user clicks the button, open the modal 
   /*btn.onclick = function() {
     modal.style.display = "block";
   }*/
   
   // When the user clicks on <span> (x), close the modal
   span.onclick = function() {closeModal();}
   
   // When the user clicks anywhere outside of the modal, close it
   window.onclick = function(event) {
     if (event.target == modal) {closeModal();}
   }
   </script>
