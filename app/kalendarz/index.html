<!DOCTYPE html>
<html lang="pl">
<head>
   <meta charset="utf-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
   <meta http-equiv="x-ua-compatible" content="ie=edge" />
   <title>nibyKal</title>  
   <meta name="HandheldFriendly" content="true">
   <meta name="mobile-web-app-capable" content="yes"> 
   <meta name="theme-color" content="#008">
   <link rel="shortcut icon" type="image/svg+xml" size="any" href="https://znakzorro.github.io/zorro/img/dom.svg"> 
   <link rel="manifest" href="https://znakzorro.github.io/zorro/zorro.web.json"> 
   <link rel="stylesheet" href="https://znakzorro.github.io/zorro/css/style.css" />  
<link rel="stylesheet" href="https://znakzorro.github.io/zorro/css/all.css" />
   
<style>     
.btn {min-width: 6.25em!important;}
body {font:normal Verdana 14pt;}
.wrapper {margin:0; padding:0;}
.container {margin:0.2em; padding:0.2em;}
table {background:#fff;}
table td {
	text-align: center;
	padding: 6px 2px;
	font-size: 14px;
	min-width: 2em;
	cursor:pointer;
}
table#tabela td.acta  {background:#666;color:#fff;}
table#tabela td.actm  {background:#222;color: orange;}
.toactive  {background:#a8a8a8;color: white;}
.b {font-weight:bold;}
.hide{visibility: hidden;}
</style>
<script>


</script>
   
          
</head>

<body>
    <div class="wrapper">
        <app-menu title="Kalendarz" name="ZnakZorro" link="../../"></app-menu>
        <script src="https://znakzorro.github.io/zorro/appMenu.js"></script>	
        <div class="container">

<h3>niby Kalendarz <span id="rok1">2023</span></h3>
		
<figure>
<table id="tabela">
	<tbody>
		<tr>
			<td colspan="5" rowspan="4"><h1><span id="rok2">2023</span></h1><span id="data"></span></td>
			<td>Sty</td>
			<td>Maj</td>
			<td>Sie</td>
			<td>Lut</td>
			<td>Czer</td>
			<td>Wrz</td>
			<td>Kwi</td>
		</tr>
		<tr>
			<td>Paź</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>Mar</td>
			<td>&nbsp;</td>
			<td>Gru</td>
			<td>Lip</td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>List</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td>01</td>
			<td>08</td>
			<td>15</td>
			<td>22</td>
			<td>29</td>
			<td>Nie</td>
			<td>Pon</td>
			<td>Wto</td>
			<td>Śro</td>
			<td>Czw</td>
			<td>Pią</td>
			<td>Sob</td>
		</tr>
		<tr>
			<td>02</td>
			<td>09</td>
			<td>16</td>
			<td>23</td>
			<td>30</td>
			<td>Pon</td>
			<td>Wto</td>
			<td>Śro</td>
			<td>Czw</td>
			<td>Pią</td>
			<td>Sob</td>
			<td>Nie</td>
		</tr>
		<tr>
			<td>03</td>
			<td>10</td>
			<td>17</td>
			<td>24</td>
			<td>31</td>
			<td>Wto</td>
			<td>Śro</td>
			<td>Czw</td>
			<td>Pią</td>
			<td>Sob</td>
			<td>Nie</td>
			<td>Pon</td>
		</tr>
		<tr>
			<td>04</td>
			<td>11</td>
			<td>18</td>
			<td>25</td>
			<td>&nbsp;</td>
			<td>Śro</td>
			<td>Czw</td>
			<td>Pią</td>
			<td>Sob</td>
			<td>Nie</td>
			<td>Pon</td>
			<td>Wto</td>
		</tr>
		<tr>
			<td>05</td>
			<td>12</td>
			<td>19</td>
			<td>26</td>
			<td>&nbsp;</td>
			<td>Czw</td>
			<td>Pią</td>
			<td>Sob</td>
			<td>Nie</td>
			<td>Pon</td>
			<td>Wto</td>
			<td>Śro</td>
		</tr>
		<tr>
			<td>06</td>
			<td>13</td>
			<td>20</td>
			<td>27</td>
			<td>&nbsp;</td>
			<td>Pią</td>
			<td>Sob</td>
			<td>Nie</td>
			<td>Pon</td>
			<td>Wto</td>
			<td>Śro</td>
			<td>Czw</td>
		</tr>
		<tr>
			<td>07</td>
			<td>14</td>
			<td>21</td>
			<td>28</td>
			<td>&nbsp;</td>
			<td>Sob</td>
			<td>Nie</td>
			<td>Pon</td>
			<td>Wto</td>
			<td>Śro</td>
			<td>Czw</td>
			<td>Pią</td>
		</tr>
	</tbody>
</table>
</figure>

<div id="info"></div> 
		
	</div> <!--container-->
 </div><!-- wraper-->
<script>

const years ={
	"2023":{
		"months":[0,5,8,20,11,6,9,23,7,10,17,32,22]
	}
}
console.log(years)
console.log(years["2023"]["months"]);

const getDays = (year, month) => {
    return new Date(year, month, 0).getDate();
};
//console.log(getDays(2023,1))


const removeAll=(a=true,b=true)=>{
	if(a) document.querySelectorAll("table#tabela td").forEach((td)=>{td.classList.remove("acta");td.classList.remove("actm");});
	if(b) document.querySelectorAll("table#tabela tr").forEach((tr)=>{tr.classList.remove("active");});
}
const clickTD=(e)=>{
	document.getElementById("info").innerHTML ="";
	//console.log(e);
	let td=e.target;
	let _nr = td.id.split("_")[1];
	let nr = parseInt(_nr);

	let modCol = nr %12;
	document.getElementById("info").innerHTML += `nr=${nr}, mCol=${modCol}`;
	
	if (modCol<5){
		let trp=td.parentNode; 
		removeAll(false,true);
		trp.classList.add("active");		
	}
	
	if (modCol<5) return;
	removeAll(true,false);
	
	for (i=0; i<11; i++){
		let mr = modCol + (i*12);
		let id = "td_"+mr;
		try{
			document.getElementById(id).classList.add("acta");
		}	catch (error) {
			//console.log(error);
		}
	}
	td.classList.add("actm");
		////////////////////////////////////////////////
			let clickMonth = null;
			for (m=1; m<14; m++){
				
				if (years["2023"]["months"][m]===nr) {clickMonth = m;break;}
			}
			if (clickMonth) {
				let lastDay = getDays(2023,clickMonth);
				let mids = [52,64,76];

				for (m=0; m<3;m++){					
					document.getElementById("td_"+mids[m]).textContent="";
				}

				let s = Math.abs(31-lastDay-3);
				for (m=0; m<s;m++){	
					document.getElementById("td_"+mids[m]).textContent=29+m;
				}
				document.getElementById("info").innerHTML += `, lastD=${lastDay}, `;
			}
		///////////////////////////////////////	
}


const todayDate=()=>{
    const pad=(s)=>{ return ("0"+s.toString()).slice(-2); }
	const getMiesiac = date => ["Styczeń","Luty","Marzec","Kwiecień","Maj","Czerwiec","Lipiec","Sierpień","Wrzesień","Październik","Listopad","Grudzień"][date.getMonth()];
	const getMie = date => ["Sty","Lut","Mar","Kwi","Maj","Cze","Lip","Sie","Wrz","Paź","Lis","Gru"][date.getMonth()];
    let weekdays = ["Niedziela", "Poniedziałek", "Wtorek", "Środa", "Czwartek", "Piątek", "Sobota"];
	let wdays = ["Nie", "Pon", "Wto", "Śro", "Czw", "Pią", "Sob"];
    let d = new Date();
    let rok     = d.getFullYear().toString();
    let miesiac = pad(d.getMonth()+1);
    let dzien   = pad(d.getDate());
    let dw      = d.getDay();
	console.log(rok,miesiac,dzien,dw,wdays[dw],weekdays[dw],getMie(d),getMiesiac(d));
	document.querySelector("#data").innerHTML=dzien+". "+getMiesiac(d)+", "+weekdays[dw];
	let tab = document.querySelector("table#tabela");
	//console.log(tab);
	const dzi = String(dzien);
	const mie = getMie(d);
	
	let dmatches = null;
	let mmatches = null;
	for (const td of tab.querySelectorAll('td')) {
		if (!td.id) continue;
		if (td.textContent.includes(dzi)) {dmatches=(td);}
		if (td.textContent.includes(mie)) {mmatches=(td);}
	}
	//for (const td of tab.querySelectorAll('td')) {if (td.textContent.includes(mie)) {matches.push(td);}}
	//console.log(dmatches);
	//console.log(mmatches);
	dmatches.classList.add("toactive");
	mmatches.classList.add("toactive");
	//clickTD
	dmatches.click();
	mmatches.click();



}
 
document.addEventListener("DOMContentLoaded",function(){
   let tds = document.querySelectorAll("table#tabela td");
	//console.log(tds);
	let j=4;
	tds.forEach((td,i)=>{
		if (i===8 || i===15 || i===22) j+=5;
		let nr = i+j;
		if (i!=0) td.id="td_"+nr;
		//console.log(i,nr,td);
		td.addEventListener('click', clickTD, false); 
		if (nr<48) td.classList.add("b");
	});
	let trs = document.querySelectorAll("table#tabela tr");
	let trsLen = trs.length;
	for (i=trsLen-7; i<trsLen; i++){
		//console.log(i,trs[i]);
		let tds = trs[i].querySelectorAll("td");
		//console.log(i,tds);
		for (t=0; t<5; t++){
			tds[t].classList.add("b");
		}
	}
	todayDate();
});
</script>
</body>
</html>
